# FF_SmsServer Domoticz plug-in/Plugin Domoticz pour FF_SmsServer
Domoticz's plug-in to allow users sending SMS containing commands to be executed by Domoticz.

Ce plugin Domoticz execute des commandes envoyées par SMS.

## What's for?/A quoi ça sert ?

This Domoticz plugin reads all SMS received by a (FF) SMS server. If first command's word is equal to a given prefix, rest of command is analyzed as a valid command. Errors during analysis are returned as SMS to command's sender. If no errors, command is sent to Domoticz and result sent back to sender, still by SMS.

Ce plugin Domoticz lit les SMS reçus par un serveur (FF) SMS. Si le premier mot de la commande est égal à un préfixe donné, le reste de la commande est analysée. Les erreurs sont renvoyées à l'expéditeur par SMS. Si la commande est correcte, elle est envoyée à Domoticz, et le résultat est retourné à l'expéditeur, toujours par SMS.

## Note
There are 2 versions of this code:
- https://github.com/FlyingDomotic/FF_SmsServerDomoticz.git, which is a Linux service implementation, with lot of manual configuration parameters, including devices classes,
- https://github.com/FlyingDomotic/domoticz-ff_smsserver-plugin.git (this code), which runs as Domoticz's plug-in, with simple configuration file, generated by python script directly from Domoticz device database.

You may choose version best suited for you.

Il y a 2 versions de ce code :
- https://github.com/FlyingDomotic/FF_SmsServerDomoticz.git, implémenté sous forme de service Linux, avec de nombreux paramètres de configuration, incluant des classes de dispositifs,
- https://github.com/FlyingDomotic/domoticz-ff_smsserver-plugin.git (ce code), qui tourne en tant que plugin Domoticz, avec un fichier de configuration simple, généré un script python directement depuis la base de dispositifs Domoticz.

Choisissez la version qui vous va le mieux.

## Prerequisites/Prérequis

You must have a (FF) SMS server (https://github.com/FlyingDomotic/FF_SmsServer.git) properly configured and running somewhere on your network.

Vous devez avoir un serveur (FF) SMS (https://github.com/FlyingDomotic/FF_SmsServer.git) correctement configuré et tournant quelque part dans votre réseau.

## Installation

Follow these steps:

 ```
cd domoticz/plugins
git clone https://github.com/FlyingDomotic/domoticz-ff_smsserver-plugin.git FF_SmsServer
```
2. Copy all files from /examples folder to FF_SmsServer plugin root folder.
3. If defaults settings don't fit you needs, edit FF_SmsServerConfig.json to match your requirements.
4. Run FF_SmsServerConfig.py script, which will create smsTables.json file.
5. Run makeDoc.py script, which will create config.txt file, sorted by Domoticz device name, containing available commands on your installation. Don't forget to add chosen prefix (by default domoticz) in front of each command.
6. Restart Domoticz.
7. Make sure that "Accept new Hardware Devices" is enabled in Domoticz settings.
8. Go to "Hardware" page and add new item with type "FF_SmsServer with LAN interface".
9. Give "smsTables.json" as configuration file name to be used (located in FF_SmsServer plugin folder).

1. Clonez le code dans le répertoire plugins de Domoticz.
```
cd domoticz/plugins
git clone https://github.com/FlyingDomotic/domoticz-ff_smsserver-plugin.git FF_SmsServer
```
2. Copiez tous les fichiers du répertoire /examples vers le répertoire racine du plugin FF_SmsServer.
3. Si les valeurs par défaut ne vous conviennent pas, éditer le fichier FF_SmsServerConfig.json pour l'adapter àà vos besoins.
4. Lancez le script FF_SmsServerConfig.py qui va générer le fichier smsTables.json.
5. Lancez le script makeDoc.py qui va générer le fichier config.txt, qui contient, trié par nom de dispositif Domoticz, les commandes disponibles sur votre installation. Ne pas oublier d'ajouter le préfixe choisi (par défaut domoticz) devant toutes les commandes.
6. Relancez Domoticz.
7. Assurez vous que "Accepter de nouveaux dispositifs" est coché dans les paramètres de Domoticz.
8. Allez dans la page "Matériel" et ajouter un matériel "FF_SmsServer with LAN interface".
9. Donnez le nom "smsTables.json" pour le fichier de configuration JSON (situé dans le répertoire du plugin FF_SmsServer).

## Update/Mise à jour

1. Go to code folder and pull new version:
```
cd [where you installed domoticz-ff_smsserver-plugin]
git pull
```
2. If you modified any files coming from /examples folder, check for differences from original versions, and apply changes against new versions. If you don't changed them, just copy /examples files to FF_SmsServer plugin root folder.

Changes will be applied at next Domoticz restart (or plug-in reload)

Note: if you did any changes to files and `git pull` command doesn't work for you anymore, you could stash all local changes using:
```
git stash
```
or
```
git checkout [modified file]
```
1. Allez dans le répertoire où vous avez installé le plugin et mettez-le à jour :
```
cd [là_où_vous_avez_installé_domoticz-ff_smsserver-plugin]
git pull
```
2. Si vous avez modifié des fichiers en provenance du répertoire /examples, recherchez les différences par rapport à la version originale, et reportez les dans les nouvelles versions. Sinon, copiez simplement tous les fichiers du répertoire /examples vers le répertoire racine du plugin FF_SmsServer.

Note: si vous avez modifié des fichiers et que la commande `git pull` ne fonctionne pas, vous pouvez annuler les changements par :
```
git stash
```
ou
```
git checkout [fichier modifié]
```
## Principle/Principe

General command organization is: [prefix] [command] [device name] [value to set].

For example: "domoticz turn kitchen light on", "domoticz open living room shutter", "domoticz set living room air conditioning to 21", ...

Code allows to work with UTF-8 data. You may optionally restrict comparison and/or output to 7 bits ASCII equivalent to help processing, allowing to remove accentuated characters (even if useful for 

List of available commands can be found into config.txt, after running makeDoc.py.

La structure de la commande est : [préfixe] [command] [device type] [device name] [value to set].

Par exemple : `domotique allume la lampe de la cuisine`, `domotique ouvre le volet du salon`, `domotique règle la consigne de la clim du séjour sur 21`, ...

Le code utilise du texte codé en UTF-8. Vous pouvez restreindre la comparaison et/ou l'affichage en mode 7 bits ASCII, ce qui éliminera les caractères accentués.

La liste des commandes disponibles est donnée dans le fichier config.txt, après avoir lancé le fichier makeDoc.py.

## Files/Fichiers

The following files should be present into plugin folder:
- smsTables.json: configuration file describing devices and commands.
- FF_SmsServerConfig.py: script to generate smsTables.json using Domoticz internal device list.
- FF_SmsServerConfig.json: parameter file for FF_SmsServerConfig.py.
- smsTablesEN.template: English JSON template file.
- smsTablesFR.json: French JSON template file.
- smsCommands.lua: example of LUA script to support "setBy": "user" set commands
- FF_analyzeCommand.py: contains common code used to parse smsTables.json, and parse SMS commands against them.
- checkJsonFiles.py: check syntax and relationships of smsTables.json and allows you to test legality of commands (without executing them).
- makeDoc.py: generate a list of commands supported by your configuration.
- plugin.py: reads SMS message, check for prefix, parse command and execute it if legal.

Les fichiers suivants doivent être présents dans le répertoire du plugin :
- smsTables.json: fichier de configuration décrivant les dispositifs et les commandes.
- FF_SmsServerConfig.py: script pour générer smsTables.json à partir de la liste interne des dispositifs Domoticz.
- FF_SmsServerConfig.json: fichier de paramètres FF_SmsServerConfig.py.
- smsTablesEN.template: template JSON pour l'anglais.
- smsTablesFR.json: template JSON pour le français.
- smsCommands.lua: example de script LUA supportant les commandes "setBy": "user"
- FF_analyzeCommand.py: contient le code utilisé pour lire smsTables.json, et vérifier/décoder les commandes SMS.
- checkJsonFiles.py: vérifie la syntaxe et les relations du fichier smsTables.json. Permet aussi de vérifier le format des commandes (sans les exécuter).
- makeDoc.py: génère une liste des commandes supportées par votre configuration.
- plugin.py: lit les SMS, vérifie le préfixe, analyse la commande et l'exécute si elle est correcte.

## Generated smsTables.json content/Contenu du fichier smsTables.json généré

This (auto-generated) json configuration file contains the following parts (in any order):
- "settings": contains settings parameters. They are copied from FF_SmsServerConfig.json.
	- "xxxVersion" are used to check file versions
	- "smsServerxxxTopic" list MQTT topics used to communicate with SMS server
	- "smsServerPrefix" contain command prefix to discriminate between domoticz instances and server instances
	- "domoticzxxTopic" contains Domoticz in and out topics
	- "domoticzUrl" contains URL to use to connect to Domoticz (and get list of devices)
	- "language" contains either "FR" or "EN" as supported languages for templates
	- "automaticUpdate" is reserved for future use (will have to be set to "false" if user modifies some files to avoid overwriting them)
	- "keepDomoticzDeviceList", when set to "true", saves Domoticz device list to FF_SmsServerConfigDeviceList.json file. I can ask to change it to get precise data from you site, when debugging.
	- "showHiddenDevices", when set to true, will include hidden (starting with "$") devices
	- "showUsedDevices", when set to true, will include only used devices (else, even unused devices will be included)
- "ignores": contains keywords to be ignored (like `the`, `of`, `to`...). All these keywords will be removed from message before parsing.
- "commandValues": contains binary values of the different commands. Typical implementation could be like:
	- "cdeOn": {"codeValue": 1}, to turn a device on,
	- "cdeOff":{"codeValue":2}, to turn a device off,
	- "cdeSet":{"codeValue":8,"set":true}, to set a device to any numerical or string value,
	- "cdeShow":{"codeValue":4}, to show current value of a device.
- "commands": contains the commands to implement. Same action can be supported by multiple values (i.e. `light`, `open` to set a device on). `Commands` maps to `mappingValues`.
- "devices": define supported Domoticz devices (not necessarily with their real names).
	- "idx" contains Domoticz device idx
	- "category" contains device category, based on device type, subtype and switch type
	- "allow" contains list of commandValues supported by this device
	- "setType" contains one of the following types, if device allow contains "cdeSet"
		- "level" when device supports setLevel commands,
		- "setPoint", when device supports setPoint commands,
		- "integer", "float" or "string" if type is not one of the already listed.
	- "mapping" can contain list of value mapping like {"Off": 0, "On": 100, "Middle": 50}
	- "minValue" can contain minimum value
	- "maxValue" can contain maximum value
	- "list" can contain a list of allowed value like {"aaa", "bbb", "ccc"} or {12, 17, 54, 66}. Useful to restrict text or numerical values
	- "setBy" can contain either "plugIn" (default) or "user". When set to user, fully decoded received command is written to "SMS user request" Domoticz device. It then should be scanned for change by some user script, and changes should be done through the script (an example is provided in /examples/smsCommand.lua). If "setBy" contains "plugin", changes will be done automatically depending on device type.

Here's an example of smsTables.json (English version generated from smsTableEN.template file:
```
{
	"settings": {
		"templateVersion": "V1.0.0",
		"configVersion": "V1.0.0",
		"smsServerReceiveTopic": "smsServer/received",
		"smsServerSendTopic": "smsServer/toSend",
		"smsServerLwtTopic": "smsServer/LWT",
		"smsServerPrefix": "domoticz",
		"domoticzInTopic": "domoticz/in",
		"domoticzOutTopic": "domoticz/out",
		"domoticzUrl": "http://127.0.0.1:8080/",
		"language": "FR",
		"automaticUpdate": true,
		"keepDomoticzDeviceList": false,
		"showHiddenDevices": false,
		"showUsedDeviceOnly": true
	},
	"ignores": [
		"of",
		"the",
		"=",
		"to"
	],
	"commandValues": {
		"cdeOn": {"codeValue": 1},
		"cdeOff": {"codeValue": 2},
		"cdeShow": {"codeValue": 4},
		"cdeSet": {"codeValue": 8, "set": true}
	},
	"commands": {
		"turn": {"commandValue": "cdeSet"},
		"arm": {"commandValue": "cdeOn"},
		"open": {"commandValue": "cdeOn"},
		"disarm": {"commandValue": "cdeOff"},
		"close": {"commandValue": "cdeOff"},
		"state": {"commandValue": "cdeShow"},
		"display": {"commandValue": "cdeShow"},
		"set": {"commandValue": "cdeSet"},
		"define": {"commandValue": "cdeSet"}
	},
	"devices": {
		"Internet access": {"index": 1, "category": "Contact", "allow": ["cdeShow"]},
		"Chicken door alarme": {"index": 12, "category": "Text", "allow": ["cdeShow"]},
		"Car remaining distance": {"index": 99, "category": "Custom Sensor", "allow": ["cdeShow"]},
		"Laundry": {"index": 68, "category": "Color Dimmer", "allow": ["cdeShow", "cdeOn", "cdeOff", "cdeSet"], "setType": "level", "minValue": 0, "maxValue": 100, "mapping": {"on": 100, "off": 0}},
		"Domoticz RPi CPU": {"index": 19, "category": "Percentage", "allow": ["cdeShow"]},
		"Granary boiler": {"index": 89, "category": "Selector", "allow": ["cdeShow", "cdeSet"], "setType": "level", "mapping": {"Off": 0, "Auto": 10, "On": 20, "Auto-Off": 30}},
		"lounge air conditioning": {"index": 67, "category": "On/Off", "allow": ["cdeShow", "cdeOn", "cdeOff"]},
		"Laundry detector": {"index": 57, "category": "Motion Sensor", "allow": ["cdeShow"]},
		"Chicken door state": {"index": 88, "category": "Selector", "allow": ["cdeShow", "cdeSet"], "setType": "level", "mapping": {"In transition": 0, "Closed": 10, "Open": 20, "** Error **": 30}},
		"Laundry fire detector": {"index": 44, "category": "Smoke Detector", "allow": ["cdeShow"]},
		"laundry illumination": {"index": 69, "category": "Lux", "allow": ["cdeShow"]},
		"Living room temperature": {"index": 8, "category": "Temp", "allow": ["cdeShow"]},
		"Test": {"index": 33, "category": "Push On Button", "allow": ["cdeShow", "cdeOn"]},
		"Living room air conditioning thermostat": {"index": 22, "category": "Setpoint", "allow": ["cdeShow", "cdeSet"], "setType": "setPoint", "minValue": -40, "maxValue": 100}
	}
}
```

Le fichier de configuration json (auto-généré) contient les éléments suivants (dans n'importe quel ordre) :
- "settings": contient les paramètres de configuration.
	- "xxxVersion" utilisés pour vérifier les versions des fichiers json et template
	- "smsServerxxxTopic" liste les topics MQTT utilisés pour communiquer avec le serveur SMS
	- "smsServerPrefix" contient le préfixé utilisé pour discriminer les instances Domoticz et les instances serveur
	- "domoticzxxTopic" contient les topics Domoticz in et out
	- "domoticzUrl" contient l'URL à utiliser pour se conencted à Domoticz (et récupérer la liste des dispositifs)
	- "language" contient le code du langage à utiliser pour les templates ("FR" ou "EN")
	- "automaticUpdate" est réservé pour un usage futur (devra être mis à "false" quand l'utilisateur modifiera certains fichier pour éviter de les écraser)
	- "keepDomoticzDeviceList", si mis à "true", enregistre une copie de la liste des dispositifs Domoticz dans le fichier FF_SmsServerConfigDeviceList.json file. Je pourrais le demander pour récupérer la liste exacte des données lors d'un déverminage
	- "showHiddenDevices", inclue les dispositifs cachés (commençant par "$") si mis à "true"
	- "showUsedDevices", inclue seulement les dispositifs utilisés si mis à "true" (sinon, même les dispositifs inutilisés seront inclus)
- "ignores": contient les mots clef à ignorer (comme `le`, `la`, `de`...). Tous ces mots clef seront supprimés du message avant traitement,
- "commandValues": contient les valeurs binaires des différentes commandes. Par exemple :
	- "cdeOn": {"codeValue": 1}, pour allumer un dispositif,
	- "cdeOff":{"codeValue":2}, pour éteindre un dispositif,
	- "cdeSet":{"codeValue":8,"set":true}, pour définir une valeur numérique ou chaîne sur un dispositif,
	- "cdeShow":{"codeValue":4}, pour afficher la valeur associée à un dispositif,
- "commands": contient les commandes à implementer. La même action peut être définie de plusieurs façons (par exemple `allume`, `ouvre` pour mettre un dispositif sur on). `Commands` pointe vers `mappingValues`.
- "devices": définit les dispositifs Domoticz utilisés (pas forcement sous leur nom original) :
	- "idx" contient l'idx (identifiant) Domoticz du dispositif
	- "category" contient la catégorie du dispositif, basé sur le type, sous type et type de switch
	- "allow" contient la liste des ommandValues supportées par ce dispositif
	- "setType" contient une des valeurs suivantes, si le dispositif supporte la commande "cdeSet"
		- "level" lorsque le dispositif supporte la commande setLevel,
		- "setPoint" lorsque dispositif supporte la commande setPoint,
		- "integer", "float" or "string" si le type n'est pas dans la liste précédente.
	- "mapping" peut contenir la liste de correspondance des valeurs, telle que {"Off": 0, "On": 100, "Middle": 50}
	- "minValue" peut contenir la valeur minimale
	- "maxValue" peut contenir la valeur maximale
	- "list" peut contenir la liste des valeurs autorisées telle que {"aaa", "bbb", "ccc"} ou {12, 17, 54, 66}. Pratique pour restreindre les valeurs textes ou numériques
	- "setBy" peut contenir soit "plugIn" (par défaut) ou "user". Lorsque mis à "user", la commande complètement décodée sera écrite dans le dispositif Domoticz "SMS user request". Il doit alors être examiné par un script utilisateur qui doit apporter les modifications requises (un exemple est fourni dans le fichier /examples/smsCommand.lua). Si "setBy" contient "plugin", les modifications seront apportées automatiquement pas le plugin, en fonction du type de dispositif.

Voici un exemple de fichier smsTables.json (version française générée depuis le fichier smsTableFR.template) :
```
{
	"settings": {
		"templateVersion": "V1.0.0",
		"configVersion": "V1.0.0",
		"smsServerReceiveTopic": "smsServer/received",
		"smsServerSendTopic": "smsServer/toSend",
		"smsServerLwtTopic": "smsServer/LWT",
		"smsServerPrefix": "domoticz",
		"domoticzInTopic": "domoticz/in",
		"domoticzOutTopic": "domoticz/out",
		"domoticzUrl": "http://127.0.0.1:8080/",
		"language": "FR",
		"automaticUpdate": true,
		"keepDomoticzDeviceList": false,
		"showHiddenDevices": false,
		"showUsedDeviceOnly": true
	},
	"ignores": [
		"de",
		"du",
		"des",
		"d'",
		"le",
		"la",
		"les",
		"l'",
		"à",
		"a",
		"=",
		"sur"
	],
	"commandValues": {
		"cdeOn":{"codeValue":1},
		"cdeOff":{"codeValue":2},
		"cdeShow":{"codeValue":4},
		"cdeSet":{"codeValue":8,"set":true}
	},
	"commands": {
		"allume":{"commandValue":"cdeOn"},
		"arme":{"commandValue":"cdeOn"},
		"ouvre":{"commandValue":"cdeOn"},
		"éteins":{"commandValue":"cdeOff"},
		"désarme":{"commandValue":"cdeOff"},
		"ferme":{"commandValue":"cdeOff"},
		"état":{"commandValue":"cdeShow"},
		"affiche":{"commandValue":"cdeShow"},
		"règle":{"commandValue":"cdeSet"},
		"définis":{"commandValue":"cdeSet"}
	},
	"devices": {
		"Accès Internet": {"index": 1, "category": "Contact", "allow": ["cdeShow"]},
		"Alarme poulailler": {"index": 12, "category": "Text", "allow": ["cdeShow"]},
		"Autonomie restante voiture": {"index": 99, "category": "Custom Sensor", "allow": ["cdeShow"]},
		"Buanderie": {"index": 68, "category": "Color Dimmer", "allow": ["cdeShow", "cdeOn", "cdeOff", "cdeSet"], "setType": "level", "minValue": 0, "maxValue": 100, "mapping": {"on": 100, "off": 0}},
		"CPU RPi Domoticz": {"index": 19, "category": "Percentage", "allow": ["cdeShow"]},
		"Chauffe eau grenier": {"index": 89, "category": "Selector", "allow": ["cdeShow", "cdeSet"], "setType": "level", "mapping": {"Off": 0, "Auto": 10, "On": 20, "Auto-Off": 30}},
		"Clim salon": {"index": 67, "category": "On/Off", "allow": ["cdeShow", "cdeOn", "cdeOff"]},
		"Détecteur buanderie": {"index": 57, "category": "Motion Sensor", "allow": ["cdeShow"]},
		"Etat porte poulailler": {"index": 88, "category": "Selector", "allow": ["cdeShow", "cdeSet"], "setType": "level", "mapping": {"En transition": 0, "Fermé": 10, "Ouvert": 20, "** Erreur **": 30}},
		"Fumée buanderie": {"index": 44, "category": "Smoke Detector", "allow": ["cdeShow"]},
		"Luminosité buanderie": {"index": 69, "category": "Lux", "allow": ["cdeShow"]},
		"Température séjour 1": {"index": 8, "category": "Temp", "allow": ["cdeShow"]},
		"Test": {"index": 33, "category": "Push On Button", "allow": ["cdeShow", "cdeOn"]},
		"Thermostat clim séjour": {"index": 22, "category": "Setpoint", "allow": ["cdeShow", "cdeSet"], "setType": "setPoint", "minValue": -40, "maxValue": 100}
	}
}
```

## How to get list of commands supported by your implementation?/Comment obtenir une liste des commandes ?

Just run `makeDoc.py` and have a look at `config.txt` it'll generate. Here's an example of the configuration listed in the previous paragraph. First column is Domoticz device name while second one list all commands available for the device:
```
Car remaining distance	[state/display] car remaining distance
Chicken door alarme	[state/display] chicken door alarme
Chicken door state	[turn/state/display/set/define] chicken door state [In transition/Closed/Open/** Error **]
Domoticz RPi CPU	[state/display] domoticz rpi cpu
Granary boiler	[turn/state/display/set/define] granary boiler [Off/Auto/On/Auto-Off]
Internet access	[state/display] internet access
Laundry	[turn/arm/open/disarm/close/state/display/set/define] laundry [on/off/0:100]
Laundry detector	[state/display] laundry detector
Laundry fire detector	[state/display] laundry fire detector
Living room air conditioning thermostat	[turn/state/display/set/define] living room air conditioning thermostat [-40:100]
Living room temperature	[state/display] living room temperature
Test	[arm/open/state/display] test
laundry illumination	[state/display] laundry illumination
lounge air conditioning	[arm/open/disarm/close/state/display] lounge air conditioning
```
Lancer simplement `makeDoc.py` pour générer un fichier `config.txt`. Voici un exemple à partir de la configuration donnée dans le paragraphe précédent. La première colonne indique le nom du dispositif Domoticz, la seconde la liste de toutes les commandes disponibles pour le dispositif :

```
Accès Internet	[état/affiche] accès internet
Alarme poulailler	[état/affiche] alarme poulailler
Autonomie restante voiture	[état/affiche] autonomie restante voiture
Buanderie	[allume/arme/ouvre/éteins/désarme/ferme/état/affiche/règle/définis] buanderie [on/off/0:100]
CPU RPi Domoticz	[état/affiche] cpu rpi domoticz
Chauffe eau grenier	[état/affiche/règle/définis] chauffe eau grenier [Off/Auto/On/Auto-Off]
Clim salon	[allume/arme/ouvre/éteins/désarme/ferme/état/affiche] clim salon
Détecteur buanderie	[état/affiche] détecteur buanderie
Etat porte poulailler	[état/affiche/règle/définis] etat porte poulailler [En transition/Fermé/Ouvert/** Erreur **]
Fumée buanderie	[état/affiche] fumée buanderie
Luminosité buanderie	[état/affiche] luminosité buanderie
Température séjour 1	[état/affiche] température séjour 1
Test	[allume/arme/ouvre/état/affiche] test
Thermostat clim séjour	[état/affiche/règle/définis] thermostat clim séjour [-40:100]
```

## How to modify generated JSON file?/Comment modifier le fichier JSON généré ?

Even if the simplest way is to use default configuration and settings, there are cases where you want to customize a bit auto-generated file.

First of all, you may change default settings in FF_SmsServerConfig.json file and run FF_SmsServerConfig.py again. Here are the different parts and their meaning:
	- "settings": this part is identical to description of auto-generated file (except that "templateVersion" is not present)
	- "onCategories": list device categories that can receive "on" command
	- "offCategories": list device categories that can receive "off" command
	- "defineCategories": describes data that should be added for categories supporting "set" command
	- "hiddenCategories": list devices categories that should be hidden (not included in auto-generated file). Specification is Unix regular expression (in short, "Test" means hide "Test" category only, ".Test" means everything ending by "Test", "Test.*" everything starting by "Test" and ".*Test.*" everything containing "Test"). More complex specification can be found in Unix documentation under "Regular Expression"
	- "hiddenDevices": list devices names that should be hidden (not included in auto-generated file). Specification is Unix regular expression (same as above)

Script supports the following categories: Air Quality, Alert, Barometer, Blinds, Blinds Percentage, Color Dimmer, Contact, Counter, Current, Custom Sensor, Dimmer, Distance, Door Contact, Door Lock, Doorbell, Dusk Sensor, Energy, Energy Generated, Fan, Gas, Humidity, kWh, Leaf Wetness, Lux, Media Player, Motion Sensor, On/Off, Percentage, Pressure, Push Off Button, Push On Button, Rain, Scale, Selector, Smoke Detector, Soil Moisture, Solar Radiation, Sound Level, Temp, Text, Thermostat, Time, Usage, UV, Visibility, Voltage, Water, Waterflow, Wind, X10 Siren.

Only those in "onCategories", "offCategories", "defineCategories" are settable, others are only displayable. Put categories you don't want to see in "hiddenCategories" and devices you don't want to see in "hiddenDevices".

Then, you may change either smsTablesEN.template or smsTablesFR.template (depending on you language settings). You have then to run FF_SmsServerConfig.py again. These files are copied into auto-generated file, with some part replaced by FF_SmsServerConfig.py. Here are the different parts and their meaning:
	- "settings": contains "templateVersion"
	- "ignores", "commandValues" and "commands": content is identical to description of auto-generated configuration file.

If these two methods don't fit your needs, you may also copy smsTables.json under another name (for example mySmsTables.json), edit it manually and change json file name in plugin settings. You can find description of this file in chapter "Generated smsTables.json content/Contenu du fichier smsTables.json généré"

Lastly, if this still don't fit you needs, have a look at https://github.com/FlyingDomotic/FF_SmsServerDomoticz.git, which has more options and features, and runs as service, but needs a  manual configuration.

In all cases, should you think the modification you made is useful for other users, don't hesitate to share it with me through an issue, so I may integrate it in the distributed version.

And if something is missing, don't hesitate to ask me too, still opening an issue.

Même si la façon la plus simple est d'utiliser les configurations et paramètres par défaut, il y a des cas où vous pouvez souhaiter adapter un peu le fichier généré.

Tout d'abord, vous pouvez changer les paramètres par défaut dans le fichier FF_SmsServerConfig.json, puis relancer FF_SmsServerConfig.py. Voici les différents éléments et leur signification :
	- "settings": cette partie est identique à la description du fichier auto-généré (sauf que "templateVersion" n'existe pas ici)
	- "onCategories": liste les catégories de dispositifs qui peuvent recevoir une commande "on"
	- "offCategories": liste les catégories de dispositifs qui peuvent recevoir une commande "on"
	- "defineCategories": contient les données qui doivent être ajoutées aux catégories supportant la commande "set"
	- "hiddenCategories": liste les catégories de dispositifs qui doivent être cachées/ignorées. Le format est celui d'une expression régulière Unix (en gros, "Test" cache la catégorie "Test" seulement, ".Test" signifie tout ce qui se termine par "Test", "Test.*" tou ce qui commence par "Test" et ".*Test.*" tout ce qui contient "Test"). Les spécifications plus complexes sont décrites dans la documentation Unix, chercher "Regular Expression"
	- "hiddenDevices": liste les noms des ispositifs qui doivent être cachées/ignorées. Le format est celui d'une expression régulière Unix (voir précédement)

Script supports the following categories: Air Quality, Alert, Barometer, Blinds, Blinds Percentage, Color Dimmer, Contact, Counter, Current, Custom Sensor, Dimmer, Distance, Door Contact, Door Lock, Doorbell, Dusk Sensor, Energy, Energy Generated, Fan, Gas, Humidity, kWh, Leaf Wetness, Lux, Media Player, Motion Sensor, On/Off, Percentage, Pressure, Push Off Button, Push On Button, Rain, Scale, Selector, Smoke Detector, Soil Moisture, Solar Radiation, Sound Level, Temp, Text, Thermostat, Time, Usage, UV, Visibility, Voltage, Water, Waterflow, Wind, X10 Siren.

Only those in "onCategories", "offCategories", "defineCategories" are settable, others are only displayable. Put categories you don't want to see in "hiddenCategories" and devices you don't want to see in "hiddenDevices".

Ensuite, vous pouvez changer les fichiers smsTablesEN.template ou smsTablesFR.template (selon votre langue). Là encore, vous aurez à relancer ensuite FF_SmsServerConfig.py. Voici les différents éléments et leur signification :
	- "settings": contient "templateVersion"
	- "ignores", "commandValues" et "commands": leur contenu est identique ) la description du fichier de configuration auto-généré

Si ces 2 méthodes ne satisfont pas vos besoins,, vous pouvez également copier le fichier smsTables.json sous un autre nom (par exemple mySmsTables.json), editez le manuellement et modifiez le nom du fichier json à utiliser dans les paramètres du plugin. Vous trouverez une description de ce fichier au chapitre "Generated smsTables.json content/Contenu du fichier smsTables.json généré".

En dernier ressort, si ceci ne correspond toujours pas à vos besoin, jetez un oeil à https://github.com/FlyingDomotic/FF_SmsServerDomoticz.git, qui a plus d'options et de fonctions, tourne en tant que service mais a besoin d'une configuration manuelle.

Dans tous les cas, si vous pensez que vos modification pourraient être utiles aux autres utilisateurs, n'hésitez pas à les partager avec moi en créant une "issue", afin que je puisse les intégrer éventuellement dans une prochaine version.

Et si quelque chose manque, n'hésitez pas non plus à me demander, toujours en créant une "issue".